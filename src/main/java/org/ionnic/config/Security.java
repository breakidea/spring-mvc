package org.ionnic.config;import java.util.UUID;import javax.servlet.http.HttpServletRequest;import javax.servlet.http.HttpSession;/** * @author apple * */public abstract class Security {	public static final String SESSION_NAME = Security.class.getName() + ".CSRF_TOKEN";	public static final String HEADER_NAME = "X-Requested-Token";	public static final String PARAMETER_NAME = "token";	/**	 * @param request	 * @param session	 * @return	 */	public static boolean checkToken(HttpServletRequest request) {		String csrfToken = loadToken(request);		if (csrfToken == null) {			return false;		} else {			String tokenValue = request.getHeader(HEADER_NAME);			if (tokenValue == null) {				tokenValue = request.getParameter(PARAMETER_NAME);			}			return csrfToken.equals(tokenValue);		}	}	/**	 * @param request	 * @param forceUpdate	 *	 * @return	 */	public static String generateToken(HttpServletRequest request) {		String token = loadToken(request);		if (token == null) {			HttpSession session = request.getSession(true);			token = "se-" + UUID.randomUUID();			session.setAttribute(SESSION_NAME, token);		}		return token;	}	/**	 * @param request	 * @return	 */	public static String loadToken(HttpServletRequest request) {		HttpSession session = request.getSession(true);		Object token = session.getAttribute(SESSION_NAME);		if (token == null) {			return null;		} else {			return (String) token;		}	}	/**	 * @param request	 */	public static void removeToken(HttpServletRequest request) {		HttpSession session = request.getSession(true);		session.removeAttribute(SESSION_NAME);	}}